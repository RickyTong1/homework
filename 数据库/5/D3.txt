第3章  关系运算
3．1  基本内容
    1.本章的重要概念
    (1)关系的定义和四个性质；超键、候选键、主键和外键的概念。
    (2)关系模型的三类完整性规则。
    (3)关系代数的五个基本操作、四个组合操作和三个扩充操作。
    (4)元组关系演算和域关系演算的基本概念。
    (5)关系代数表达式的优化问题、等价变化规则、优化策略和语法树。
    2.本章的题材
    (1)给出关系(表)的值，计算关系代数表达式的值。
    (2)给出若干关系，根据查询语句写出关系代数表达式、元组表达式和域表达式的表达形式，或进行这些形式之间的转换。
    (3)对于给定的关系代数表达式，写出优化的式子，并画出语法树。

3．2  教材中习题3的解答

[习题3．1]名词解释
    ・关系模型：用二维表格表示实体集，外键和主键表示实体间联系的数据摸型，称为关系模型。
    ・关系模式：是对关系的描述，包括模式名、诸属性名、值域名和摸式的主键。
    ・关系实例：关系模式具体的值，称为关系实例。
    ・属性：即字段或数据项，与二维表中的列对应：属性个数。称为元数(arity)。
    ・域：属性的取值范围，称为域。
    ・元组：即记录，与二维表中的行对应。元组个数．称为基数(cardinality)。
    ・超键：能惟一标识元组的属性或属性集，称为关系的超键。
    ・候选键：不含有多余属性的超键，称为候选键。
    ・主键：正在使用的、用于标识元组的候选键．称为主键。
    ・外键：属性集F是模式S的主键，在模式R中也出现．那么称F是模式R的外键。
    ・实体完整性规则：实体的主键值不允许是空值。
    ・参照完整性规则：依赖关系中的外键值或者为主值。或者是相应参照关系中某个主键码。
    ・过程性语言：编程时必须给出获得结果的操作步骤，即指出“干什么”及“怎么干”的语言。
    ・非过程性语言：编程时，只需指出需要什么信息，不必给出具体的操作步骤，即只要指出“干什么”，不必指出“怎么干”的语言。
    ・无限关系：指元组个数为无穷多个的关系。
    ・无穷验证：验证公式真假时需要进行无限次验证。

[习题3．2]为什么关系中的元组没有先后顺序?
答：由于关系定义为元组的集合，而集合中的元素是没有顺序的，因此关系中的元组也就没有先后的顺序(对用户而言)。这样既能减少逻辑排序，又便于在关系数据库中引进集合论的理论。

[习题3．3]为什么关系中不允许有重复元组?
答：每个关系模式都有一个主键，在关系中主键值是不允许重复的。如果关系中有重复元组，那么其主键值肯定相等，起不了惟一标识作用，因此关系中不允许有重复元组。

[习题3．4]关系与普通表格、文件有什么区别?
答：与表格、文件相比，关系有下列四个不同点：
    属性值不可分解；没有重复元组；没有行序；使用时有列序。

[习题3．5]笛卡儿积、等值联接、自然联接三者之间有什么区别?
答：笛卡尔积是一个基本操作，而等值联接和自然联接是组合操作。
    设关系R的元数为r，元组个数为m；关系S的元数为s，元组个数为n。
    那么，RXS的元数为r+s，元组个数为mXn；
    RI><IS的元数也是r+s．但元组个数小于等于mXn；
      i⊙j
    RI><IS的元数小于等于r+s．元组个数也小于等于mXn。

[习题3．6] 图d3-t6

[习题3．7]如果R是二元关系，那么下列元组表达式的结果是什么?
    ｛t｜(3u)(R(t)∧R(u)∧(t[l]≠u[l]∨t[2]≠u[2]))}
  答：当R的元组数≥2时，R中每个元组都存在与之不相同的元组，因此表达式的结果为关系R；
    当R的元组数为0或1时，表达式的结果为空关系。

[习题3．8] 图d3-t8

[习题3．9] 图d3-t9

[习题3．10] 图d3-t10

[习题3．11] 图d3-t11

[习题3．12] 图d3-t12

[习题3．13] 图d3-t13

[习题3．14] 图d3-t14

[习题3．15] 图d3-t15

[习题3．16]为什么要对关系代数表达式进行优化?
答：关系代数表达式由关系代数操作组合而成。操作中，以笛卡尔积和联接操作最费时，并生成大量的中间结果。如果直接按表达式书写的顺序执行，必将花费很多时间，并生成大量的中间结果，效率较低。在执行前，由DBMS的查询子系统先对关系代数表达式进行优化，尽可能先执行选择和投影操作，以便减少中间结果，并节省时间。
    优化工作是由DBMS做的，用户书写时不必关心优化一事，仍以简练的形式书写。
